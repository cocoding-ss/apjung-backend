pipeline {
    agent any
    triggers {
        GenericTrigger {
            genericVariables: [
                [key: 'action', value: '$.action']
                [key: 'branch', value: '$.head.ref']
            ],

            token: 'kucby7dvrbjyh7yna25mchaqzzkj98zh3em0jkre',
            causeString: 'Triggered on $action',

            printContributedVariables: false,
            printPostContent: true,

            regexpFilterText: '$action',
            regexpFilterExpression: 'created|edited'
        }
    }
    stages {
        stage('Git checkout') {
            steps {
                git branch '$branch' credentialsId: 'wirome-backend', url: 'git@github.com:cocoding-ss/wirome-backend.git'
            }
        }
        stage('Gradle build') {
            steps {
                sh "./gradlew clean build -Pprofile=dev"
                echo "NUMBER : ${currentBuild.number}"
            }
        }
    }
}